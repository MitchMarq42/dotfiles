#!/bin/bash

# Excellent info at https://wiki.ubuntu.com/X/InputCoordinateTransformation

[[ $@ == "" ]] && echo "no operation specified" && exit 0

direction=$@

touchpad=$(
    xinput list |
    grep -i touchpad |
    sed 's/^.*id=//' |
    awk '{print $1}'
)
tpprop=$(
    xinput list-props $touchpad |
    grep Matrix |
    sed 's/^.*(//;s/).*$//'
)
touchscreen=$(
    xinput list |
    grep -i touchscreen |
    sed 's/^.*id=//' |
    awk '{print $1}'
)
tsprop=$(
    xinput list-props $touchscreen |
    grep Matrix |
    sed 's/^.*(//;s/).*$//'
)

[[ $direction == normal ]] &&
    export matrix="1 0 0 0 1 0 0 0 1"

[[ $direction == left ]] &&
    export matrix="0 -1 1 1 0 0 0 0 1"

[[ $direction == right ]] &&
    export matrix="0 1 0 -1 0 1 0 0 1"

[[ $direction == inverted ]] &&
    export matrix="-1 0 1 0 -1 1 0 0 1"

xinput set-prop $touchpad $tpprop $matrix
xinput set-prop $touchscreen $tsprop $matrix
xrandr -o $direction
which nitrogen >/dev/null && nitrogen --restore
