#!/bin/bash

# Brightctl, a simple switch that uses sysfs to manage the display brightness. See also: Brightnessctl.
# Run it with doas, or have the user own the brightness file.

brightness=$(cat /sys/class/backlight/*_bl0/brightness)
oldbrightness=$brightness
echo "Was $brightness"
[[ $@ == + ]] && ((brightness=($brightness+7) ))
[[ $@ == - ]] && ((brightness=($brightness-8) ))
[[ $@ == -s ]] && (echo $brightness 2>/dev/null > /etc/brightness && echo "Saved /etc/brightness as $brightness" || echo "Failed. Check your privilege.")
[[ $@ == -r || $@ == restore || $@ == --restore ]] && brightness=$(cat /etc/brightness)

echo $brightness > /sys/class/backlight/*_bl0/brightness 2>/dev/null &&
echo "Now $brightness" ||
echo "Still $oldbrightness, maybe don't expect the impossible next time?"
